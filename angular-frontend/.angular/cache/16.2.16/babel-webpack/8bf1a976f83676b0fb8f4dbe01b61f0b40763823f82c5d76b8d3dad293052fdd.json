{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { finalize } from 'rxjs/operators';\nlet CrearUsuarioComponent = class CrearUsuarioComponent {\n  fb;\n  usuarioService;\n  router;\n  usuarioForm;\n  enviando = false;\n  errorMessage = '';\n  ingenierias = [];\n  cargandoIngenierias = false;\n  constructor(fb, usuarioService, router) {\n    this.fb = fb;\n    this.usuarioService = usuarioService;\n    this.router = router;\n  }\n  ngOnInit() {\n    this.inicializarFormulario();\n    this.cargarIngenierias();\n  }\n  inicializarFormulario() {\n    this.usuarioForm = this.fb.group({\n      nombre: ['', [Validators.required, Validators.minLength(2)]],\n      apellidos: ['', [Validators.required, Validators.minLength(2)]],\n      correo: ['', [Validators.required, Validators.email, Validators.pattern(/^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$/)]],\n      telefono: ['', [Validators.required, Validators.pattern(/^[0-9]{10}$/)]],\n      id_ingenieria: ['', Validators.required],\n      contrasena: ['', [Validators.required, Validators.minLength(8)]],\n      fecha_registro: [new Date().toISOString().split('T')[0], Validators.required]\n    });\n  }\n  cargarIngenierias() {\n    this.cargandoIngenierias = true;\n    this.usuarioService.obtenerIngenierias().pipe(finalize(() => this.cargandoIngenierias = false)).subscribe({\n      next: data => {\n        this.ingenierias = data;\n        console.log('Ingenierías cargadas:', this.ingenierias);\n      },\n      error: err => {\n        console.error('Error al cargar ingenierías:', err);\n        // Usar lista de ingenierías de respaldo\n        this.ingenierias = [{\n          id_ingenieria: 1,\n          nombre_ingenieria: 'Ingeniería de Sistemas'\n        }, {\n          id_ingenieria: 2,\n          nombre_ingenieria: 'Ingeniería Electrónica'\n        }, {\n          id_ingenieria: 3,\n          nombre_ingenieria: 'Ingeniería Mecánica'\n        }, {\n          id_ingenieria: 4,\n          nombre_ingenieria: 'Ingeniería Industrial'\n        }, {\n          id_ingenieria: 5,\n          nombre_ingenieria: 'Ingeniería Ambiental'\n        }];\n      }\n    });\n  }\n  onSubmit() {\n    if (this.usuarioForm.invalid) {\n      this.usuarioForm.markAllAsTouched();\n      return;\n    }\n    this.enviando = true;\n    this.errorMessage = '';\n    const datosUsuario = {\n      nombre: this.usuarioForm.value.nombre,\n      apellido: this.usuarioForm.value.apellidos,\n      correo: this.usuarioForm.value.correo,\n      correo_electronico: this.usuarioForm.value.correo,\n      telefono: this.usuarioForm.value.telefono,\n      id_ingenieria: this.usuarioForm.value.id_ingenieria,\n      contrasena: this.usuarioForm.value.contrasena,\n      fecha_registro: this.usuarioForm.value.fecha_registro\n    };\n    this.usuarioService.crearUsuario(datosUsuario).pipe(finalize(() => this.enviando = false)).subscribe({\n      next: respuesta => {\n        console.log('Respuesta del servidor:', respuesta);\n        this.mostrarMensaje('Usuario registrado exitosamente');\n        this.router.navigate(['/admin/usuarios']);\n      },\n      error: err => {\n        console.error('Error al crear usuario:', err);\n        this.errorMessage = 'Error al crear usuario: ' + err.message;\n        this.mostrarMensaje(this.errorMessage);\n      }\n    });\n  }\n  mostrarMensaje(mensaje) {\n    alert(mensaje);\n  }\n  // Getters para acceder fácilmente a los controles del formulario en la plantilla\n  get nombreControl() {\n    return this.usuarioForm.get('nombre');\n  }\n  get apellidosControl() {\n    return this.usuarioForm.get('apellidos');\n  }\n  get correoControl() {\n    return this.usuarioForm.get('correo');\n  }\n  get telefonoControl() {\n    return this.usuarioForm.get('telefono');\n  }\n  get ingenieriaControl() {\n    return this.usuarioForm.get('id_ingenieria');\n  }\n  get contrasenaControl() {\n    return this.usuarioForm.get('contrasena');\n  }\n};\nCrearUsuarioComponent = __decorate([Component({\n  selector: 'app-crear-usuario',\n  templateUrl: './crear-usuario.component.html',\n  styleUrls: ['./crear-usuario.component.css']\n})], CrearUsuarioComponent);\nexport { CrearUsuarioComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}