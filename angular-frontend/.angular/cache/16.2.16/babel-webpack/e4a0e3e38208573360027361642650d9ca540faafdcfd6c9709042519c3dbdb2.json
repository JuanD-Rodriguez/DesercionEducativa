{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/core/services/formulario.service\";\nimport * as i3 from \"@angular/router\";\nfunction FormularioDesercionComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"p\")(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(4, \"input\", 6)(5, \"hr\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const grupo_r2 = ctx.$implicit;\n    const i_r3 = ctx.index;\n    let tmp_1_0;\n    i0.ɵɵproperty(\"formGroupName\", i_r3);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate((tmp_1_0 = grupo_r2.get(\"texto\")) == null ? null : tmp_1_0.value);\n  }\n}\nfunction FormularioDesercionComponent_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"\\u00A1Formulario enviado exitosamente!\");\n    i0.ɵɵelementEnd();\n  }\n}\nlet FormularioDesercionComponent = /*#__PURE__*/(() => {\n  class FormularioDesercionComponent {\n    fb;\n    formularioService;\n    router;\n    formulario;\n    enviado = false;\n    constructor(fb, formularioService, router) {\n      this.fb = fb;\n      this.formularioService = formularioService;\n      this.router = router;\n      this.formulario = this.fb.group({\n        respuestas: this.fb.array([]) // array de respuestas a preguntas\n      });\n    }\n\n    ngOnInit() {\n      this.cargarPreguntas();\n    }\n    get respuestas() {\n      return this.formulario.get('respuestas');\n    }\n    cargarPreguntas() {\n      this.formularioService.getPreguntas().subscribe(preguntas => {\n        preguntas.forEach(preg => {\n          this.respuestas.push(this.fb.group({\n            id_pregunta: [preg.ID_Pregunta],\n            texto: [preg.Texto_Pregunta],\n            respuesta: ['', Validators.required]\n          }));\n        });\n      });\n    }\n    enviarFormulario() {\n      if (this.formulario.valid) {\n        const respuestasFormateadas = this.respuestas.value.map(r => ({\n          id_pregunta: r.id_pregunta,\n          opcion_seleccionada: r.respuesta\n        }));\n        this.formularioService.enviarRespuestas(respuestasFormateadas).subscribe(() => {\n          this.enviado = true;\n          this.router.navigate(['/']);\n        });\n      }\n    }\n    static ɵfac = function FormularioDesercionComponent_Factory(t) {\n      return new (t || FormularioDesercionComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.FormularioService), i0.ɵɵdirectiveInject(i3.Router));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: FormularioDesercionComponent,\n      selectors: [[\"app-formulario-desercion\"]],\n      decls: 8,\n      vars: 3,\n      consts: [[3, \"formGroup\", \"ngSubmit\"], [\"formArrayName\", \"respuestas\"], [3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\"], [4, \"ngIf\"], [3, \"formGroupName\"], [\"type\", \"text\", \"formControlName\", \"respuesta\", \"placeholder\", \"Tu respuesta...\", \"required\", \"\"]],\n      template: function FormularioDesercionComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"h2\");\n          i0.ɵɵtext(1, \"Formulario de Deserci\\u00F3n\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(2, \"form\", 0);\n          i0.ɵɵlistener(\"ngSubmit\", function FormularioDesercionComponent_Template_form_ngSubmit_2_listener() {\n            return ctx.enviarFormulario();\n          });\n          i0.ɵɵelementStart(3, \"div\", 1);\n          i0.ɵɵtemplate(4, FormularioDesercionComponent_div_4_Template, 6, 2, \"div\", 2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"button\", 3);\n          i0.ɵɵtext(6, \"Enviar Formulario\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(7, FormularioDesercionComponent_p_7_Template, 2, 0, \"p\", 4);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.formulario);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.respuestas.controls);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.enviado);\n        }\n      },\n      encapsulation: 2\n    });\n  }\n  return FormularioDesercionComponent;\n})();\nexport { FormularioDesercionComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}