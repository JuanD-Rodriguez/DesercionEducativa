{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core/services/usuario.service\";\nimport * as i2 from \"src/app/core/services/prediccion.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/forms\";\nconst _c0 = function (a1) {\n  return [\"/gestor/estudiante\", a1];\n};\nconst _c1 = function (a1) {\n  return [\"/gestor/mensajes/nuevo\", a1];\n};\nfunction ListaEstudiantesComponent_div_16_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 16)(12, \"button\", 17);\n    i0.ɵɵelement(13, \"i\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function ListaEstudiantesComponent_div_16_tr_17_Template_button_click_14_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const estudiante_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.predecirEstudiante(estudiante_r5.id_estudiante));\n    });\n    i0.ɵɵelement(15, \"i\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"button\", 21);\n    i0.ɵɵelement(17, \"i\", 22);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const estudiante_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(estudiante_r5.id_estudiante);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", estudiante_r5.nombre, \" \", estudiante_r5.apellido, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(estudiante_r5.correo_electronico);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(estudiante_r5.ingenieria);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(estudiante_r5.promedio);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(8, _c0, estudiante_r5.id_estudiante));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(10, _c1, estudiante_r5.id_estudiante));\n  }\n}\nfunction ListaEstudiantesComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"table\")(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Nombre\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Correo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Carrera\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Promedio\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Acciones\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"tbody\");\n    i0.ɵɵtemplate(17, ListaEstudiantesComponent_div_16_tr_17_Template, 18, 12, \"tr\", 15);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(17);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.filtrarEstudiantes());\n  }\n}\nfunction ListaEstudiantesComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 23)(1, \"p\");\n    i0.ɵɵtext(2, \"No hay estudiantes registrados en el sistema.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ListaEstudiantesComponent_div_17_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.crearEstudiantePrueba());\n    });\n    i0.ɵɵtext(4, \"Crear Estudiante de Prueba\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ListaEstudiantesComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵelement(1, \"div\", 26);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3, \"Cargando estudiantes...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ListaEstudiantesComponent_div_19_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const error_r11 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", error_r11, \" \");\n  }\n}\nfunction ListaEstudiantesComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtemplate(1, ListaEstudiantesComponent_div_19_div_1_Template, 2, 1, \"div\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.errores);\n  }\n}\nlet ListaEstudiantesComponent = /*#__PURE__*/(() => {\n  class ListaEstudiantesComponent {\n    usuarioService;\n    prediccionService;\n    estudiantes = [];\n    filtroNombre = '';\n    cargando = true;\n    errores = [];\n    constructor(usuarioService, prediccionService) {\n      this.usuarioService = usuarioService;\n      this.prediccionService = prediccionService;\n    }\n    ngOnInit() {\n      this.cargarEstudiantes();\n    }\n    cargarEstudiantes() {\n      this.cargando = true;\n      this.errores = []; // Limpiar errores previos\n      this.usuarioService.getUsuarios().subscribe({\n        next: data => {\n          console.log('Datos de estudiantes recibidos:', data);\n          this.estudiantes = data;\n          this.cargando = false;\n          if (this.estudiantes.length === 0) {\n            console.log('No se encontraron estudiantes');\n          }\n        },\n        error: err => {\n          console.error('Error al cargar estudiantes:', err);\n          this.errores.push('Error al cargar la lista de estudiantes: ' + err.message);\n          this.cargando = false;\n        }\n      });\n    }\n    crearEstudiantePrueba() {\n      this.cargando = true;\n      this.usuarioService.crearEstudiantePrueba().subscribe({\n        next: resultado => {\n          console.log('Estudiante de prueba creado:', resultado);\n          this.cargarEstudiantes(); // Recargar la lista\n        },\n\n        error: error => {\n          console.error('Error al crear estudiante de prueba:', error);\n          this.errores.push('Error al crear estudiante de prueba: ' + error.message);\n          this.cargando = false;\n        }\n      });\n    }\n    predecirTodos() {\n      if (confirm('¿Está seguro de predecir el riesgo para todos los estudiantes? Este proceso puede tomar tiempo.')) {\n        this.cargando = true;\n        this.prediccionService.predecirGrupo({}).subscribe({\n          next: resultado => {\n            console.log('Predicción completada:', resultado);\n            this.cargando = false;\n            alert(`Se ha realizado la predicción para ${resultado.estudiantes_procesados} estudiantes.`);\n            this.cargarEstudiantes(); // Recargar los datos\n          },\n\n          error: error => {\n            console.error('Error al predecir:', error);\n            this.cargando = false;\n            this.errores.push('Error al realizar la predicción de riesgo');\n            alert('Error al realizar la predicción. Intente nuevamente.');\n          }\n        });\n      }\n    }\n    filtrarEstudiantes() {\n      if (!this.filtroNombre.trim()) {\n        return this.estudiantes;\n      }\n      const filtro = this.filtroNombre.toLowerCase();\n      return this.estudiantes.filter(est => est.nombre?.toLowerCase().includes(filtro) || est.apellido?.toLowerCase().includes(filtro));\n    }\n    predecirEstudiante(id) {\n      this.cargando = true;\n      this.prediccionService.predecirEstudiante(id).subscribe({\n        next: resultado => {\n          console.log('Predicción individual completada:', resultado);\n          this.cargando = false;\n          alert(`Predicción realizada. Riesgo de deserción: ${(resultado.riesgo_desercion * 100).toFixed(2)}%`);\n          this.cargarEstudiantes(); // Recargar los datos\n        },\n\n        error: error => {\n          console.error('Error al predecir estudiante:', error);\n          this.cargando = false;\n          this.errores.push(`Error al predecir riesgo para el estudiante ID: ${id}`);\n          alert('Error al realizar la predicción individual. Intente nuevamente.');\n        }\n      });\n    }\n    static ɵfac = function ListaEstudiantesComponent_Factory(t) {\n      return new (t || ListaEstudiantesComponent)(i0.ɵɵdirectiveInject(i1.UsuarioService), i0.ɵɵdirectiveInject(i2.PrediccionService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ListaEstudiantesComponent,\n      selectors: [[\"app-lista-estudiantes\"]],\n      decls: 20,\n      vars: 5,\n      consts: [[1, \"lista-estudiantes-container\"], [1, \"controles\"], [1, \"busqueda\"], [\"for\", \"buscar\"], [\"type\", \"text\", \"placeholder\", \"Buscar por nombre...\", 3, \"ngModel\", \"ngModelChange\"], [1, \"acciones\"], [1, \"refresh-btn\", 3, \"click\"], [1, \"fas\", \"fa-sync-alt\"], [1, \"predict-all-btn\", 3, \"click\"], [1, \"test-btn\", 3, \"click\"], [\"class\", \"estudiantes-table\", 4, \"ngIf\"], [\"class\", \"estado-vacio\", 4, \"ngIf\"], [\"class\", \"cargando\", 4, \"ngIf\"], [\"class\", \"errores\", 4, \"ngIf\"], [1, \"estudiantes-table\"], [4, \"ngFor\", \"ngForOf\"], [1, \"acciones-col\"], [1, \"action-btn\", \"view-btn\", 3, \"routerLink\"], [1, \"fas\", \"fa-eye\"], [1, \"action-btn\", \"predict-btn\", 3, \"click\"], [1, \"fas\", \"fa-chart-line\"], [1, \"action-btn\", \"message-btn\", 3, \"routerLink\"], [1, \"fas\", \"fa-envelope\"], [1, \"estado-vacio\"], [1, \"create-test-btn\", 3, \"click\"], [1, \"cargando\"], [1, \"spinner\"], [1, \"errores\"], [\"class\", \"error-mensaje\", 4, \"ngFor\", \"ngForOf\"], [1, \"error-mensaje\"]],\n      template: function ListaEstudiantesComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"Lista de Estudiantes\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"div\", 1)(4, \"div\", 2)(5, \"label\", 3);\n          i0.ɵɵtext(6, \"Buscar:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"input\", 4);\n          i0.ɵɵlistener(\"ngModelChange\", function ListaEstudiantesComponent_Template_input_ngModelChange_7_listener($event) {\n            return ctx.filtroNombre = $event;\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 5)(9, \"button\", 6);\n          i0.ɵɵlistener(\"click\", function ListaEstudiantesComponent_Template_button_click_9_listener() {\n            return ctx.cargarEstudiantes();\n          });\n          i0.ɵɵelement(10, \"i\", 7);\n          i0.ɵɵtext(11, \" Actualizar \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"button\", 8);\n          i0.ɵɵlistener(\"click\", function ListaEstudiantesComponent_Template_button_click_12_listener() {\n            return ctx.predecirTodos();\n          });\n          i0.ɵɵtext(13, \"Predecir Riesgo para Todos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(14, \"button\", 9);\n          i0.ɵɵlistener(\"click\", function ListaEstudiantesComponent_Template_button_click_14_listener() {\n            return ctx.crearEstudiantePrueba();\n          });\n          i0.ɵɵtext(15, \"Crear Estudiante de Prueba\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(16, ListaEstudiantesComponent_div_16_Template, 18, 1, \"div\", 10);\n          i0.ɵɵtemplate(17, ListaEstudiantesComponent_div_17_Template, 5, 0, \"div\", 11);\n          i0.ɵɵtemplate(18, ListaEstudiantesComponent_div_18_Template, 4, 0, \"div\", 12);\n          i0.ɵɵtemplate(19, ListaEstudiantesComponent_div_19_Template, 2, 1, \"div\", 13);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"ngModel\", ctx.filtroNombre);\n          i0.ɵɵadvance(9);\n          i0.ɵɵproperty(\"ngIf\", !ctx.cargando && ctx.estudiantes.length > 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.cargando && ctx.estudiantes.length === 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.cargando);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.errores.length > 0);\n        }\n      },\n      dependencies: [i3.NgForOf, i3.NgIf, i4.RouterLink, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel],\n      styles: [\".lista-estudiantes-container[_ngcontent-%COMP%]{padding:20px}h2[_ngcontent-%COMP%]{margin-bottom:20px;color:#333}.controles[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:20px}.busqueda[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.busqueda[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ddd;border-radius:4px;min-width:250px}.acciones[_ngcontent-%COMP%]{display:flex;gap:10px}.refresh-btn[_ngcontent-%COMP%], .predict-all-btn[_ngcontent-%COMP%]{padding:8px 15px;border:none;border-radius:4px;cursor:pointer}.refresh-btn[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#333}.predict-all-btn[_ngcontent-%COMP%]{background-color:#333;color:#fff}.estudiantes-table[_ngcontent-%COMP%]{width:100%;overflow-x:auto;margin-bottom:20px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #eee}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:600;color:#333}.acciones-col[_ngcontent-%COMP%]{display:flex;gap:8px}.action-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:4px;border:none;cursor:pointer;display:flex;justify-content:center;align-items:center}.view-btn[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#2196f3}.predict-btn[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#4caf50}.message-btn[_ngcontent-%COMP%]{background-color:#fff3e0;color:#ff9800}.estado-vacio[_ngcontent-%COMP%], .cargando[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center;background-color:#f8f9fa;border-radius:8px;color:#666}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(0,0,0,.1);border-left-color:#333;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:15px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.errores[_ngcontent-%COMP%]{margin-top:20px}.error-mensaje[_ngcontent-%COMP%]{padding:10px 15px;background-color:#ffebee;color:#c62828;border-radius:4px;margin-bottom:10px}@media (max-width: 768px){.controles[_ngcontent-%COMP%]{flex-direction:column;gap:15px}.busqueda[_ngcontent-%COMP%], .acciones[_ngcontent-%COMP%]{width:100%}.busqueda[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}}\"]\n    });\n  }\n  return ListaEstudiantesComponent;\n})();\nexport { ListaEstudiantesComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}